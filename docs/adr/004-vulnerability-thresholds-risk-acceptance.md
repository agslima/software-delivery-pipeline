
Architecture Decision Record (ADR)

ADR 004: Vulnerability Thresholds & Risk Acceptance

Status: Accepted

Date: 2026-01-07

Context: Software Delivery Pipeline – Security Risk Management



---

Context

Modern software supply chains inevitably consume third-party dependencies and base images that may contain known vulnerabilities. While zero vulnerabilities is an ideal target, it is rarely achievable in practice without severely impacting delivery velocity.

This project integrates automated vulnerability scanning using:

Trivy – Static vulnerability analysis (OS packages & application dependencies)

OWASP ZAP – Dynamic Application Security Testing (DAST)


A key architectural question is how to define acceptable risk thresholds and how to handle violations in a way that balances:

Security rigor

Developer productivity

Operational realism



---

Decision

The project adopts a risk-based vulnerability acceptance model with explicit thresholds:

Trivy (SCA / Image Scanning)

Severity	Policy

Critical	❌ Block
High	⚠️ Limited tolerance
Medium	Allowed
Low / Unknown	Allowed


OWASP ZAP (DAST)

Finding Level	Policy

High	❌ Block
Medium	⚠️ Review
Low / Informational	Allowed


Thresholds are enforced via Cosign attestations and evaluated by Kyverno policies at cluster admission time.


---

Rationale

1. Risk-Based Security (Not Binary Security)

Binary security models (“any vulnerability = fail”) lead to:

Excessive false negatives

Developer fatigue

Security controls being bypassed or disabled


By explicitly codifying acceptable risk, this project reflects real-world security governance.


---

2. Separation of Detection and Enforcement

Detection occurs in CI (Trivy & ZAP)

Enforcement occurs at admission time (Kyverno)


This ensures:

Scans run early and often

Decisions are enforced only when artifacts are immutable and signed



---

3. Auditability and Intent

Risk acceptance is not implicit.

Thresholds are encoded in:

Kyverno policies

Attestation predicates


Any change to thresholds requires:

Policy modification

Code review

Git history



This provides a strong audit trail.


---

Implementation Details

Trivy Attestation Enforcement

Trivy generates an in-toto attestation with summarized vulnerability counts:

{
  "result": "PASS",
  "summary": {
    "critical": 0,
    "high": 0,
    "medium": 3,
    "low": 3
  }
}

Kyverno enforces:

critical == 0

high <= defined threshold



---

OWASP ZAP Attestation Enforcement

ZAP produces an attestation summarizing DAST results.

Kyverno policies validate:

result == PASS

No High severity findings



---

CI Behavior

CI logs all findings

CI does not fail solely on vulnerability count

Enforcement is deferred to admission control


This prevents repeated pipeline failures during remediation cycles.


---

Consequences

Positive

Balanced Security Posture: Focuses effort on the highest risks.

Reduced Alert Fatigue: Developers are not blocked by low-impact issues.

Clear Governance Model: Thresholds are explicit and reviewable.

Production-Grade Design: Mirrors enterprise vulnerability management practices.



---

Negative / Trade-offs

Accepted Residual Risk: Medium/Low vulnerabilities may exist in production.

Requires Continuous Review: Thresholds must be periodically reassessed.

Potential Misuse: Poorly chosen thresholds could weaken security if not governed.


These risks are mitigated by documentation, review discipline, and policy versioning.


---

Alternatives Considered

1. Zero-Tolerance Policy

Rejected because:

Unrealistic for most real-world systems

Leads to stalled pipelines

Encourages security bypasses



---

2. Manual Risk Acceptance Only

Rejected because:

Does not scale

Lacks consistency

Provides weak auditability
